Παρακάτω περιγράφουμε τη διαδικασία εισαγωγής των δύο προγραμμάτων που έχουμε φτιάξει σε node-red.

---


># ΔΙΑΔΙΚΑΔΙΑ ΕΙΣΑΓΩΓΗΣ ΚΩΔΙΚΑ ΣΕ NODERED

---


## Βήμα 1ο

Aνοίγουμε ένα φυλλομετρητή της αρεσκείας μας , κατά προτίμηση Google Chrome  Mozilla Firefox. Στη γραμμή διεύθυνσης γράφουμε την **διεύθυνση IP του κεντρικού σταθμού** του έργου ακολουθούμενη από την **πόρτα 1880** στην οποία ακούει η υπηρεσία του node-red. 
Ακολούθως ανοίγει ο συντάκτης και το περιβάλλον του node-red,  των οποίων μπορούμε είτε να γράψουμε καινούργιες καρτέλες (ροές-flows)  ή να εισάγουμε  κάποιες ήδη υπάρχουσες είτε με αντιγραφή επικόλληση είτε από κάποιο αρχείο που περιέχει τον κώδικα μας. 
Στην περίπτωση έχουμε έτοιμο το αρχείο με τις ροές που περιγράφονται παρακάτω και  που υλοποιούν τη λογική της αποστόλης εντολών στον τοπικό σταθμό  της κάθε τάξης,  στην περίπτωσή μας η αίθουσα πληροφορικής

![περιβάλλον του node-red](https://github.com/epal-aliartou/AI-School-Assistant/blob/main/images/0-editor-Node-RED%20_%20KENTRIKO.png)


## Βήμα 2ο

Από το μενού βρίσκεται  πού βρίσκεται  πάνω και δεξιά  το περιβάλλον του node-red,  δηλαδή τις τρεις γραμμούλες,  επιλέγουμε στην εντολή του μενού import


![import](https://github.com/epal-aliartou/AI-School-Assistant/blob/main/images/3-Import-flows-Node-RED-KENTRIKO.png)


## Βήμα 3ο

Στο παράθυρο που εμφανίζεται,  επιλέγουμε clipboard, from file,  new flow

![lipboard, from file,  new flow](https://github.com/epal-aliartou/AI-School-Assistant/blob/main/images/4-Import-dialogue-flows-Node-RE%20-KENTRIKO.png)


## Βήμα 4ο

το παράθυρο διαλόγου που εμφανίζεται,  επιλέγουμε το αρχείο που θέλουμε,  στην περίπτωσή μας το flow.json

Έχοντας κάνει τα παραπάνω βήματα,  θα εμφανιστούν στο περιβάλλον του την τακτική node-red

δύο καρτέλες με το πρόγραμμα που έχουμε φτιάξει  για να εκτελεί ο κεντρικός σταθμός 

πιο συγκεκριμένα στην πρώτη,  με όνομα projector timer

![επιλέγουμε το αρχείο flow.json](https://github.com/epal-aliartou/AI-School-Assistant/blob/main/images/5-Import-file-dialogue-flows-Node-RED-KENTRIKO.png)

---


># ΕΠΕΞΗΓΗΣΗ ΚΩΔΙΚΑ ΣΕ NODERED

---



> # 1.ΕΝΤΟΛΕΣ MQTT ΑΠΟ ΚΕΝΤΡΙΚΟ ΣΕ ΤΟΠΙΚΟΥΣ
Στην πρώτη καρτέλα του node-red, έχουμε φτιάξει την αντίστοιχη  Ρόη (flow)  που ασχολείται με την αποστολή, **ανάλογα με τη λογική που επιλέξουμε** από τον  κεντρικό προς τους τοπικούς σταθμούς των τάξεων.  Η συγκεκριμένη υλοποίηση είναι ενδεικτική, και φυσικά μπορεί να επεκταθεί με τον ίδιο μηχανισμό και σε οποιοδήποτε αριθμό αιθουσών,εντολών και τοπικών σταθμών καθώς  και με προγραμματιζόμμενη  λογική.

Πιο συγκεκριμένα, στον πρώτο κόμβο επιλέγουμε ποια θα είναι η εντολή, καθώς επίσης και αν θα είναι περιοδική έχοντες επίσης δυνατότητα να καθορίσουμε και πολλές άλλες ιδιότητες της.

Το δεύτερο κόμβο καθορίζουμε προς τα πού απευθύνεται η εντολή. Με άλλα λόγια, καθορίζουμε το θέμα (topic) στο οποίο θα εκπέμψει η εντολή. Στην ουσία λοιπόν, μέσω ροής κάνουμε το κεντρικό έναν εκδότη publisher,   προς τον  Mosquitto broker.  Φυσικά για να ολοκληρωθεί η επικοινωνία,  θα πρέπει οι ενδιαφερόμενοι σταθμοί  να γίνουν συνδρομητές  subscriber  στο αντίστοιχο θέμα topic.

Τέλος,  χρησιμοποιώντας το περιβάλλον  για debug  του node red,   εισάγουμε τον  τρίτο κόμβο,  ο οποίος είναι υπεύθυνος για να μας δείχνει πληροφορίες στο debug window του nodered

[MQTT-command-from-KENTRIKO](https://github.com/epal-aliartou/AI-School-Assistant/blob/main/images/2-MQTT-command-from-KENTRIKO-NodeRED.png)

---



> # 2.ΧΡΟΝΟΠΡΟΓΡΑΜΜΑΤΙΣΜΟΣ ΑΙΘΟΥΣΑΣ 1 (ΕΡΓΑΣΤΗΡΙΟ ΠΛΗΡΟΦΟΡΙΚΗΣ)

---


Στην δεύτερρη  καρτέλα του node-red, έχουμε φτιάξει μια Ρόη (flow)  που ασχολείται με την αποστολή, ανάλογα με τον **χρονοπρογραματισμό**  που επιλέξουμε από τον  κεντρικό προς τους τοπικούς σταθμούς των τάξεων ή προς συγκεκριμμένες συσκευές.  Η συγκεκριμένη υλοποίηση είναι ενδεικτική, και φυσικά μπορεί να επεκταθεί με τον ίδιο μηχανισμό και σε οποιοδήποτε αριθμό αιθουσών,εντολών και τοπικών σταθμών καθώς  και με ευρύτερο  προγραμματιζόμμενη.

[projector-timer](https://github.com/epal-aliartou/AI-School-Assistant/blob/main/images/1-projector-timer-Node-RED-KENTRIKO-.png)

Τα πιο σημαντικά στοιχεία (κόμβοι -nodes) φαίνονται  την εικόνα και περιγράφονται παρακάτω

1. **easy-timer** :  Το βασικό στοιχείο του προγραμματισμού  με βάση  τον χρόνο

2. **MQTT output node** : Ο Κόμβος αυτός συνδέεται με έναν άλλο   κρυφό κόμβο,  στον οποίον έχουμε προσδιορίσει όλα τα στοιχεία του πραγματικού MQTT  broker.  Επομένως μέσω αυτού του  MQTT  broker προσπαθεί να μεταδώσει τα μηνύματά του.  Αυτό που κάνουμε  στη διαμόρφωση του συγκεκριμένου κόμβου  είναι να προσδιορίζουμε το θέμα  (topic)  προς το οποίο θα γίνει μετάδοση.  Φυσικά όσοι ενδιαφέρονται πρέπει να γίνουν συνδρομητές σε αυτό.

3. Ο Κόμβος αυτός,  κρύβει πίσω του μία συνάρτηση (**JavaScript function**).  Μέσα  από αυτή την  συνάρτηση  κάνουμε έλεγχο λαθών καθώς και φιλτράρισμα  του περιεχομένου του μηνύματος.

4. Όλοι οι κόμβοι που στην εικόνα έχουντον  αριθμό 4,   αναπαριστούν στοιχεία της **ιστοσελίδας (dashboard του node red)**  παίρνοντας στοιχεία από τη λογική και κάνοντας  τα εμφανή μέσω μιας ιστοσελίδας , δίνοντας δηλαδή στην εφαρμογή ένα web interface για πέρασμα των απαραίτητων παραμέτρων.

5. Για να χρησιμοποιήσουμε  το περιβάλλον  **debugging**   του node red,   εισάγουμε τον  τελευταίο κόμβο,  ο οποίος είναι υπεύθυνος για να μας δείχνει πληροφορίες στο debug window του nodered

6.Τέλος,  επιδεικνύουμε και την θέση του **μενού** μέσω του οποίου μπορούν να γίνουν ενέργειες όπως και η **εισαγωγή ή  εξαγωγή κώδικα** την οποία δείξαμε προηγουμένως 

6-WEBui-Node-RED-KENTRIKO.png

---


> # 2.ΧΡΟΝΟΠΡΟΓΡΑΜΜΑΤΙΣΜΟΣ ΑΙΘΟΥΣΑΣ 1 (ΕΡΓΑΣΤΗΡΙΟ ΠΛΗΡΟΦΟΡΙΚΗΣ)

---

Κάνοντας κλικ  πάνω δεξιά  το εικονίδιο με το βελάκι ,  στην καρτέλα dashboard , εμφανίζεται μία καινούργια σελίδα στον φυλλομετρητή. Αυτή είναι μια  ιστοσελίδα στην οποία μπορούμε να περάσουμε παραμέτρους για τον προγραμματισμό  του βιντεοπροβολέα της αίθουσας πληροφορικής.  Το στοιχεία μου φαίνονται  στην ιστοσελίδα αυτή καθορίζονται από τους κόμβους της ροής που περιγράψαμε προηγουμένως.  

Φυσικά η αυτή υλοποίηση είναι ενδεικτική και θα μπορούσαν να γίνουν όσες ιστοσελίδες (dashboard) θέλουμε , στις οποίες θα ελέγχουμε παραμέτρους από άλλες συσκευές και από άλλες αίθουσες.

Πιο συγκεκριμένα,  το web interface της ενδεικτικής αυτής εφαρμογής φαίνονται παρακάτω

[6-WEBui-Node-RED-KENTRIKO.png](https://github.com/epal-aliartou/AI-School-Assistant/blob/main/images/6-WEBui-Node-RED-KENTRIKO.png)
